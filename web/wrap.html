<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>git</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="stylesheet" type="text/css" href="dagre.css" />
    <link rel="stylesheet" type="text/css" href="jquery.terminal.css" />
  </head>
  <body>

    <div class="emscripten" id="status">Downloading...</div>
    <div class="emscripten">
      <progress value="0" max="100" id="progress" hidden=1></progress>  
    </div>

    <svg height="800px" width="100%" style="border:none;">
      <defs>
        <marker id="arrowhead"
                viewBox="0 0 10 10"
                refX="8"
                refY="5"
                markerUnits="strokeWidth"
                markerWidth="8"
                markerHeight="5"
                orient="auto"
                style="fill: #333">
                <path d="M 0 0 L 10 5 L 0 10 z"></path>
        </marker>
      </defs>
    </svg>

    <div draggable="true" id="terminal_drag" class="drag">
      <div id="term_demo"></div>
    </div>

    <style>
    code {
      border-radius: 3px;
      background-color: #fff;
      border: solid 1px #efeee6;
      color: #f14e32;
      font-family: Courier,monospace;
      line-height: 18px;
    }
    </style>

    <div draggable="true" id="textbook_drag" class="drag" style="height: 20em; overflow: scroll">
      <h1> 9.3 Git Internals - Git References</h1>
      <h2> Git References </h2>
 <p>You can run something like <code>git log 1a410e</code> to look through your whole history, but you still have to remember that <code>1a410e</code> is the last commit in order to walk that history to find all those objects. You need a file in which you can store the SHA-1 value under a simple name so you can use that pointer rather than the raw SHA-1 value.</p>

 <p>In Git, these are called &quot;references&quot; or &quot;refs&quot;; you can find the files that contain the SHA-1 values in the <code>.git/refs</code> directory. In the current project, this directory contains no files, but it does contain a simple structure:</p>

 <pre><code>$ ls .git/refs&#x000A;. .. heads tags&#x000A;</code></pre>

 <p>To create a new reference that will help you remember where your latest commit is, you can technically do something as simple as this:</p>

 <pre><code>$ echo &quot;1a410efbd13591db07496601ebc7a059dd55cfe9&quot; &gt; .git/refs/heads/master&#x000A;</code></pre>

 <p>Now, you can use the head reference you just created instead of the SHA-1 value in your Git commands:</p>

 <pre><code>$ git log --pretty=oneline  master&#x000A;1a410efbd13591db07496601ebc7a059dd55cfe9 third commit&#x000A;cac0cab538b970a37ea1e769cbbde608743bc96d second commit&#x000A;fdf4fc3344e67ab068f836878b6c4951e3b15f3d first commit&#x000A;</code></pre>

 <p>You aren’t encouraged to directly edit the reference files. Git provides a safer command to do this if you want to update a reference called <code>update-ref</code>:</p>

 <pre><code>$ git update-ref refs/heads/master 1a410efbd13591db07496601ebc7a059dd55cfe9&#x000A;</code></pre>

 <p>That’s basically what a branch in Git is: a simple pointer or reference to the head of a line of work. To create a branch back at the second commit, you can do this:</p>

 <pre><code>$ git update-ref refs/heads/test cac0ca&#x000A;</code></pre>

 <p>Your branch will contain only work from that commit down:</p>

 <pre><code>$ git log --pretty=oneline test&#x000A;cac0cab538b970a37ea1e769cbbde608743bc96d second commit&#x000A;fdf4fc3344e67ab068f836878b6c4951e3b15f3d first commit&#x000A;</code></pre>

 <p>Now, your Git database conceptually looks something like Figure 9-4.</p>

 <p><center><img src="/figures/18333fig0904-tn.png"></center><br/>
 Figure 9-4. Git directory objects with branch head references included.</p>

 <p>When you run commands like <code>git branch (branchname)</code>, Git basically runs that <code>update-ref</code> command to add the SHA-1 of the last commit of the branch you’re on into whatever new reference you want to create.</p>
    </div>



    <div draggable="true" id="explorer_drag" class="drag">
      <div><span>Explorer</span><span id="close" class="clickable" style="float:right; font-family:monospace;">x</span></div>
      <div id="directory_listing"></div>
      <textarea id="text_editor" rows=10></textarea>
      <span class="clickable" id="save">save</span>
    </div>

    <script src="jquery.min.js"></script>
    <script>
      $("#close").click(function() {
        $("#explorer_drag").hide();
      });
      $("#explorer_drag").hide();
      $("#terminal_drag").hide();
    </script>


    <script src="drag.js"></script>

    <!--<a href="https://github.com/zodiac/libgit2.js"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png" alt="Fork me on GitHub"></a>

    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36868476-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
-->
    <script src="libgit-pre.js"></script>

    <script src="timeline.js"></script>
    <script src="functions.js"></script>

    <script src="d3.v2.min.js"></script>
    <script src="dagre.js"></script>
    <script src="graphing.js"></script>

    <script src="git-terminal.js"></script>
    <script src="jquery.terminal-0.6.3.min.js"></script>
    <script>
    $('#term_demo').terminal(function(command, term) {
        if (command !== '') {
            try {
                var result = git_eval(command);
                if (result !== undefined) {
                    term.echo(new String(result));
                }
            } catch(e) {
                term.error(new String(e));
                throw e;
            }
        } else {
           term.echo('');
        }
    }, {
        greetings: 'libgit2.js - type help for a list of commands',
        name: 'js_demo',
        height: 200,
        prompt: '> '});
    </script>

  </body>
</html>
